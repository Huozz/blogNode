webpackJsonp([4],{GHqW:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("Dd8w"),n=o.n(i),r=o("NYxO"),a=o("LGbv"),s=(o("zXdv"),o("oAV5")),l={data:function(){return{loading:!1,form:{id:"",title:"",data:"",description:"",content:""},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{type:"string",max:32,message:"标题长度不大于32字符",trigger:"change"}],description:[{required:!0,message:"请输入博客描述",trigger:"blur"}],content:[{required:!0,message:"请输入博客正文",trigger:"blur"}]},submitButton:{loading:!1,disabled:!1},toolBars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}},components:{TokenDialog:a.a},computed:n()({},Object(r.b)(["token"])),mounted:function(){var t=this;if(!this.token)return this.message({message:"权限不足,请绑定token",type:"error"}),void this.$router.go(-1);this.form.id=this.$route.params.id,this.$http.get("/api/articleDetail/"+this.$route.params.id).then(function(e){var o=e.body;console.log("article",o),t.form.id=t.$route.params.id,t.form.title=o.title,t.form.description=o.description,t.form.content=o.content})},methods:{imageAdd:function(t,e){var o=this;console.log(e),console.log("base_api","http://localhost:3000/");var i=new FormData;i.append("file",e),s.a.uploadImage(i).then(function(e){o.$refs.md.$img2Url(t,"http://localhost:3000/"+e.data.url)}).catch(function(t){console.log(t)})},onSubmit:function(){var t=this;this.token?this.publish():this.$refs.tokenDialog.open(function(){t.publish()})},change:function(t,e){this.form.content=e},publish:function(){var t=this,e=this;this.$refs.form.validate(function(o){if(o){t.submitButton.loading=!0,t.submitButton.disabled=!0;var i={};i._id=t.form.id,i.title=t.form.title,i.description=t.form.description,i.content=t.form.content,i.date=s.a.getDate(),console.log(t.form),e.$http.post("/api/admin/updateArticle",{articleInformation:i}).then(function(e){t.$message({message:"修改成功!",type:"success"}),t.$router.push("/user/blog/details/"+i._id),t.submitButton.loading=!1,t.submitButton.disabled=!1})}})},goBack:function(){this.$router.go(-1)}}},c={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-card",[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"描述",prop:"description"}},[o("el-input",{attrs:{type:"text-area"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"博客正文",prop:"content"}},[o("mavon-editor",{ref:"md",staticStyle:{"max-height":"500px"},attrs:{toolbars:t.toolBars},on:{imgAdd:t.imageAdd,change:t.change},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",loading:t.submitButton.loading,disabled:t.submitButton.disabled},on:{click:t.onSubmit}},[t._v("修改")]),t._v(" "),o("el-button",{on:{click:t.goBack}},[t._v("返回")])],1)],1)],1),t._v(" "),o("token-dialog",{ref:"tokenDialog"})],1)},staticRenderFns:[]};var d=o("VU/8")(l,c,!1,function(t){o("aVyG")},"data-v-7f7364e4",null);e.default=d.exports},aVyG:function(t,e){}});
//# sourceMappingURL=4.99aaaeefd72a6fdfad54.js.map