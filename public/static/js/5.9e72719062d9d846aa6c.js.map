{"version":3,"sources":["webpack:///src/views/blog/Add.vue","webpack:///./src/views/blog/Add.vue?b35f","webpack:///./src/views/blog/Add.vue"],"names":["Add","data","form","title","description","content","date","submitButton","loading","disabled","rules","required","message","trigger","type","max","toolbars","bold","italic","header","underline","strikethrough","mark","superscript","subscript","quote","ol","ul","link","imagelink","code","table","fullscreen","readmodel","htmlcode","help","undo","redo","trash","save","navigation","alignleft","aligncenter","alignright","subfield","preview","components","TokenDialog","TokenDialogue","computed","extends_default","Object","vuex_esm","methods","imgAdd","pos","$file","_this","this","console","log","formData","FormData","append","utils","uploadImage","then","res","$refs","md","$img2Url","url","catch","err","change","value","render","onSubmit","publish","_this2","self","validate","valid","getDate","$http","post","articleInformation","response","$message","$router","push","blog_Add","_vm","_h","$createElement","_c","_self","staticStyle","minheight","attrs","shadow","ref","model","label-width","label","prop","callback","$$v","$set","expression","_v","max-height","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"gLA2BAA,GACAC,KADA,WAEA,OACAC,MACAC,MAAA,GACAC,YAAA,GACAC,QAAA,GACAC,KAAA,IAEAC,cACAC,SAAA,EACAC,UAAA,GAGAC,OACAP,QACAQ,UAAA,EAAAC,QAAA,QAAAC,QAAA,SACAC,KAAA,SAAAC,IAAA,GAAAH,QAAA,eAAAC,QAAA,WAEAT,cACAO,UAAA,EAAAC,QAAA,UAAAC,QAAA,SAEAR,UACAM,UAAA,EAAAC,QAAA,UAAAC,QAAA,UAIAG,UACAC,MAAA,EACAC,QAAA,EACAC,QAAA,EACAC,WAAA,EACAC,eAAA,EACAC,MAAA,EACAC,aAAA,EACAC,WAAA,EACAC,OAAA,EACAC,IAAA,EACAC,IAAA,EACAC,MAAA,EACAC,WAAA,EACAC,MAAA,EACAC,OAAA,EACAC,YAAA,EACAC,WAAA,EACAC,UAAA,EACAC,MAAA,EAEAC,MAAA,EACAC,MAAA,EACAC,OAAA,EACAC,MAAA,EAEAC,YAAA,EAEAC,WAAA,EACAC,aAAA,EACAC,YAAA,EAEAC,UAAA,EACAC,SAAA,KAKAC,YACAC,YAAAC,EAAA,GAGAC,SAAaC,OACbC,OAAAC,EAAA,EAAAD,EACA,WAIAE,SAEAC,OAFA,SAEAC,EAAAC,GAAA,IAAAC,EAAAC,KAGAC,QAAAC,IAAAJ,GACAG,QAAAC,IAAA,qCACA,IAAAC,EAAA,IAAAC,SACAD,EAAAE,OAAA,OAAAP,GACSQ,EAAA,EAATC,YAAAJ,GACAK,KAAA,SAAAC,GAGAV,EAAAW,MAAAC,GAAAC,SAAAf,EAAA,yBAAAY,EAAAlE,KAAAsE,OAEAC,MAAA,SAAAC,GACAd,QAAAC,IAAAa,MAIAC,OApBA,SAoBAC,EAAAC,GACAlB,KAAAxD,KAAAG,QAAAuE,GAEAC,SAvBA,WAgCAnB,KAAAoB,WAEAA,QAlCA,WAkCA,IAAAC,EAAArB,KAEAsB,EAAAtB,KACAA,KAAAU,MAAA,KAAAa,SAAA,SAAAC,GACAA,IAEAH,EAAAxE,aAAAC,SAAA,EACAuE,EAAAxE,aAAAE,UAAA,EACAsE,EAAA7E,KAAAI,KAAA0D,EAAA,EAAAmB,UACAJ,EAAAK,MAAAC,KAAA,0BACAC,mBAAAP,EAAA7E,OACAgE,KACA,SAAAqB,GACAP,EAAAQ,UACA5E,QAAA,SACAE,KAAA,YAIAkE,EAAAS,QAAAC,KAAA,oBAEA,SAAAH,GAAA,OAAA5B,QAAAC,IAAA2B,WC1JeI,GADEf,OAFjB,WAA0B,IAAAgB,EAAAlC,KAAamC,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,aAAaC,UAAA,WAAqBH,EAAA,WAAgBI,OAAOC,OAAA,WAAkBL,EAAA,WAAgBM,IAAA,OAAAF,OAAkBG,MAAAV,EAAA1F,KAAAQ,MAAAkF,EAAAlF,MAAA6F,cAAA,UAAyDR,EAAA,gBAAqBI,OAAOK,MAAA,KAAAC,KAAA,WAA6BV,EAAA,YAAiBO,OAAO3B,MAAAiB,EAAA1F,KAAA,MAAAwG,SAAA,SAAAC,GAAgDf,EAAAgB,KAAAhB,EAAA1F,KAAA,QAAAyG,IAAiCE,WAAA,iBAA0B,GAAAjB,EAAAkB,GAAA,KAAAf,EAAA,gBAAqCI,OAAOK,MAAA,KAAAC,KAAA,iBAAmCV,EAAA,YAAiBO,OAAO3B,MAAAiB,EAAA1F,KAAA,YAAAwG,SAAA,SAAAC,GAAsDf,EAAAgB,KAAAhB,EAAA1F,KAAA,cAAAyG,IAAuCE,WAAA,uBAAgC,GAAAjB,EAAAkB,GAAA,KAAAf,EAAA,gBAAqCI,OAAOK,MAAA,OAAAC,KAAA,aAAiCV,EAAA,gBAAqBM,IAAA,KAAAJ,aAAsBc,aAAA,SAAqBZ,OAAQvD,UAAA,EAAA5B,SAAA4E,EAAA5E,UAAyCgG,IAAK1D,OAAAsC,EAAAtC,OAAAoB,OAAAkB,EAAAlB,QAAwC4B,OAAQ3B,MAAAiB,EAAA1F,KAAA,QAAAwG,SAAA,SAAAC,GAAkDf,EAAAgB,KAAAhB,EAAA1F,KAAA,UAAAyG,IAAmCE,WAAA,mBAA4B,GAAAjB,EAAAkB,GAAA,KAAAf,EAAA,gBAAAA,EAAA,aAAqDI,OAAOrF,KAAA,UAAAN,QAAAoF,EAAArF,aAAAC,QAAAC,SAAAmF,EAAArF,aAAAE,UAAyFuG,IAAKC,MAAArB,EAAAf,YAAsBe,EAAAkB,GAAA,oBAAAlB,EAAAkB,GAAA,KAAAf,EAAA,gBAA4DM,IAAA,iBAAkB,IAEjwCa,oBCCjB,IAcAC,EAdyBC,EAAQ,OAcjCC,CACErH,EACA2F,GATF,EAVA,SAAA2B,GACEF,EAAQ,SAaV,kBAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/5.9e72719062d9d846aa6c.js","sourcesContent":["<template>\n   <div style=\"minheight:600px\">\n      <el-card shadow=\"never\">\n         <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\n            <el-form-item  label=\"标题\" prop=\"title\">\n               <el-input v-model=\"form.title\"></el-input>\n            </el-form-item>\n            <el-form-item  label=\"描述\" prop=\"description\">\n               <el-input v-model=\"form.description\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"博客正文\" prop=\"content\">\n               <mavon-editor @imgAdd=\"imgAdd\" @change=\"change\" v-model=\"form.content\" style=\"max-height: 500px\" ref=\"md\" :subfield=\"false\" :toolbars=\"toolbars\"></mavon-editor>\n            </el-form-item>\n            <el-form-item>\n               <el-button type=\"primary\" @click=\"onSubmit\" :loading=\"submitButton.loading\" :disabled=\"submitButton.disabled\">发表</el-button>\n            </el-form-item>\n         </el-form>\n      </el-card>\n      <token-dialog ref=\"tokenDialog\"></token-dialog>\n   </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\nimport TokenDialog from '../common/TokenDialogue.vue'\nimport GistApi from '../../api/gist'\nimport utils from '../../utils/utils'\nexport default {\n   data () {\n      return {\n         form:{\n            title:'',\n            description:'',\n            content: '',\n            date: ''\n         },\n         submitButton:{\n            loading: false,\n            disabled: false\n         },\n         // 填入的文章标题、文章描述、正文内容验证\n         rules:{\n            title:[\n               {required: true, message:'请输入标题',trigger:'blur'},\n               {type: 'string', max:32, message:'标题长度不超过32个字符', trigger:'change'}\n            ],\n            description: [\n               {required: true, message:'请输入简要描述', trigger:'blur'}\n            ],\n            content:[\n               {required: true, message:'请输入博客正文', trigger:'blur'}\n            ]\n         },\n         // 文本编辑的组件\n         toolbars: {\n               bold: true, // 粗体\n               italic: true, // 斜体\n               header: true, // 标题\n               underline: true, // 下划线\n               strikethrough: true, // 中划线\n               mark: true, // 标记\n               superscript: true, // 上角标\n               subscript: true, // 下角标\n               quote: true, // 引用\n               ol: true, // 有序列表\n               ul: true, // 无序列表\n               link: true, // 链接\n               imagelink: true, // 图片链接\n               code: true, // code\n               table: true, // 表格\n               fullscreen: true, // 全屏编辑\n               readmodel: true, // 沉浸式阅读\n               htmlcode: true, // 展示html源码\n               help: true, // 帮助\n               /* 1.3.5 */\n               undo: true, // 上一步\n               redo: true, // 下一步\n               trash: true, // 清空\n               save: true, // 保存（触发events中的save事件）\n               /* 1.4.2 */\n               navigation: true, // 导航目录\n               /* 2.1.8 */\n               alignleft: true, // 左对齐\n               aligncenter: true, // 居中\n               alignright: true, // 右对齐\n               /* 2.2.1 */\n               subfield: true, // 单双栏模式\n               preview: true, // 预览\n         }\n      };\n   },\n\n   components: {\n      TokenDialog\n   },\n\n   computed: {\n      ...mapGetters([\n         'token'\n      ])\n   },\n\n   methods: {\n      // 以formatdata格式上传\n      imgAdd(pos, $file){\n         // this.$refs['md'].$img2Url(pos, file.miniurl)\n               //以formdata格式上传\n         console.log($file)\n         console.log(\"base_api\",process.env.API_ROOT)\n         let formData = new FormData();\n         formData.append(\"file\",$file);\n         utils.uploadImage(formData)\n         .then(res => {\n               // this.$refs.md.$img2Url 作用是把Markdown里上传成功的图片url替换为服务器返回的url\n            // this.$refs.md.$img2Url(pos, this.baseUrl + res.url);\n            this.$refs.md.$img2Url(pos, process.env.API_ROOT + res.data.url);\n         })\n         .catch(err => {\n            console.log(err);\n         });\n      },\n\n      change(value,render){\n         this.form.content = render\n      },\n      onSubmit(){\n         // // 检查token是否通过验证，如果没有则弹出token验证框\n         // if(this.token){\n         //    this.publish()\n         // }else{\n         //    this.$refs.tokenDialog.open(()=>{\n         //       this.publish()\n         //    })\n         // }\n         this.publish()\n      },\n      publish(){\n         // 先验证要新增的博客内容是否有效\n         let self = this;\n         this.$refs['form'].validate((valid)=>{\n            if(valid){\n               // 表单验证通过，按钮进入加载状态，禁用再次点击\n               this.submitButton.loading = true\n               this.submitButton.disabled = true\n               this.form.date = utils.getDate()\n               this.$http.post('/api/admin/saveArticle', {\n                  articleInformation: this.form\n               }).then(\n                  response => {\n                  self.$message({\n                     message: '更新文章成功',\n                     type: 'success'\n                  })\n                  // 更新完成后跳转至该文章的详情页\n                  // self.$router.push('details/' + self.$route.params.id)\n                  self.$router.push('/user/blog/main')\n                  },\n                  response => console.log(response)\n               )\n            }\n         })\n      }\n   }\n}\n</script>\n<style lang='css' scoped>\n\n</style>\n\n\n// WEBPACK FOOTER //\n// src/views/blog/Add.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"minheight\":\"600px\"}},[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"描述\",\"prop\":\"description\"}},[_c('el-input',{model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"博客正文\",\"prop\":\"content\"}},[_c('mavon-editor',{ref:\"md\",staticStyle:{\"max-height\":\"500px\"},attrs:{\"subfield\":false,\"toolbars\":_vm.toolbars},on:{\"imgAdd\":_vm.imgAdd,\"change\":_vm.change},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.submitButton.loading,\"disabled\":_vm.submitButton.disabled},on:{\"click\":_vm.onSubmit}},[_vm._v(\"发表\")])],1)],1)],1),_vm._v(\" \"),_c('token-dialog',{ref:\"tokenDialog\"})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c6438fd\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/blog/Add.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c6438fd\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Add.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Add.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Add.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c6438fd\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Add.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4c6438fd\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/blog/Add.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}